---
# Gemini CLI installation tasks

- name: Install gemini-cli globally via npm
  ansible.builtin.command: npm install -g @google/gemini-cli
  become: true
  when: app_states['gemini-cli'] | default('present') == 'present'
  register: gemini_cli_install
  failed_when: false
  changed_when: gemini_cli_install.rc == 0

- name: Uninstall gemini-cli globally via npm
  ansible.builtin.command: npm uninstall -g @google/gemini-cli
  become: true
  when: app_states['gemini-cli'] | default('present') == 'absent'
  register: gemini_cli_uninstall
  failed_when: false
  changed_when: gemini_cli_uninstall.rc == 0
